import { generateReactNativeStyles } from "../shared/ReactNativeStylesGenerator";
export const createCssModulesTransformer = (upstreamTransformer) => {
    return {
        transform: async (transformerOptions) => {
            const { filename, options } = transformerOptions;
            if (options.platform !== "web") {
                if (filename.endsWith(".scss") || filename.endsWith(".sass") || filename.endsWith(".css")) {
                    const { styles } = generateReactNativeStyles(Object.assign(Object.assign({}, transformerOptions), { platform: options.platform }));
                    return upstreamTransformer.transform({
                        src: "module.exports = " + JSON.stringify(styles),
                        filename,
                        options,
                    });
                }
            }
            return upstreamTransformer.transform(transformerOptions);
        },
    };
};
