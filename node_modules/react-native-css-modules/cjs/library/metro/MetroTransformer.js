"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createCssModulesTransformer = void 0;
const ReactNativeStylesGenerator_1 = require("../shared/ReactNativeStylesGenerator");
const createCssModulesTransformer = (upstreamTransformer) => {
    return {
        transform: async (transformerOptions) => {
            const { filename, options } = transformerOptions;
            if (options.platform !== "web") {
                if (filename.endsWith(".scss") || filename.endsWith(".sass") || filename.endsWith(".css")) {
                    const { styles } = (0, ReactNativeStylesGenerator_1.generateReactNativeStyles)(Object.assign(Object.assign({}, transformerOptions), { platform: options.platform }));
                    return upstreamTransformer.transform({
                        src: "module.exports = " + JSON.stringify(styles),
                        filename,
                        options,
                    });
                }
            }
            return upstreamTransformer.transform(transformerOptions);
        },
    };
};
exports.createCssModulesTransformer = createCssModulesTransformer;
